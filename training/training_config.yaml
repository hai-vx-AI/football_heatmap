# Training Configuration for All Models

# =============================================================================
# 1. YOLO Fine-tuning Configuration
# =============================================================================
yolo_training:
  # Base model
  base_model: "yolo11n.pt"  # or yolo11s.pt, yolo11m.pt, yolo11x.pt
  
  # Data
  data_yaml: "input/SoccerNet/yolo_dataset/data.yaml"
  
  # Training parameters
  epochs: 50  # Reduced from 100 for faster training on CPU
  batch: 8  # Reduced from 16 for CPU
  imgsz: 640  # Reduced from 1280 for CPU
  device: "cpu"  # cuda, cpu, or 0,1,2,3 for multi-GPU
  workers: 8
  
  # Optimizer
  optimizer: "SGD"  # SGD, Adam, AdamW
  lr0: 0.01  # Initial learning rate
  lrf: 0.01  # Final learning rate (lr0 * lrf)
  momentum: 0.937
  weight_decay: 0.0005
  warmup_epochs: 3
  warmup_momentum: 0.8
  warmup_bias_lr: 0.1
  cos_lr: false  # Use cosine learning rate scheduler
  
  # Loss weights
  box: 7.5  # Box loss gain
  cls: 0.5  # Class loss gain
  dfl: 1.5  # DFL loss gain
  
  # Data augmentation
  augment: true
  hsv_h: 0.015  # Hue augmentation
  hsv_s: 0.7    # Saturation augmentation
  hsv_v: 0.4    # Value augmentation
  degrees: 0.0  # Rotation (+/- deg)
  translate: 0.1  # Translation (+/- fraction)
  scale: 0.5    # Scale (+/- gain)
  shear: 0.0    # Shear (+/- deg)
  perspective: 0.0  # Perspective (+/- fraction)
  flipud: 0.0   # Flip up-down probability
  fliplr: 0.5   # Flip left-right probability
  mosaic: 1.0   # Mosaic augmentation probability
  mixup: 0.0    # Mixup augmentation probability
  copy_paste: 0.0  # Copy-paste augmentation probability
  
  # Advanced
  close_mosaic: 10  # Disable mosaic last N epochs
  label_smoothing: 0.0
  nbs: 64  # Nominal batch size
  amp: true  # Automatic Mixed Precision
  fraction: 1.0  # Dataset fraction to train on
  cache: false  # Cache images (ram or disk)
  
  # Output
  project: "runs/train"
  name: "yolo_football"
  exist_ok: true
  resume: false
  save_period: -1  # Save checkpoint every N epochs (-1 to disable)
  
  # Export
  export_onnx: false


# =============================================================================
# 2. Team Classifier Configuration
# =============================================================================
team_classifier:
  # Data
  data_dir: "data/jersey_crops"  # Will be created by prepare script
  
  # Model
  pretrained: true  # Use ImageNet pretrained weights
  image_size: 224
  
  # Training parameters
  epochs: 50
  batch_size: 32
  learning_rate: 0.001
  weight_decay: 0.0001
  num_workers: 0  # Set to 0 for Windows compatibility
  device: "cpu"
  
  # Output
  output_dir: "runs/team_classifier"
  save_freq: 10  # Save checkpoint every N epochs


# =============================================================================
# 3. Ball Trajectory Predictor Configuration
# =============================================================================
ball_predictor:
  # Data
  data_dir: "data/ball_trajectories"  # Will be created by prepare script
  sequence_length: 10  # Input sequence length (frames)
  prediction_horizon: 5  # Predict N frames ahead
  
  # Model
  model_type: "lstm"  # lstm or transformer
  
  # LSTM parameters
  hidden_dim: 128
  num_layers: 2
  dropout: 0.2
  
  # Transformer parameters (if model_type == "transformer")
  d_model: 128
  nhead: 8
  # num_layers: 4  # Reuse num_layers
  
  # Training parameters
  epochs: 100
  batch_size: 128
  learning_rate: 0.001
  weight_decay: 0.00001
  num_workers: 0  # Set to 0 for Windows compatibility
  device: "cpu"
  
  # Output
  output_dir: "runs/ball_predictor"
  save_freq: 20  # Save checkpoint every N epochs
